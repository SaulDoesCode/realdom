(function(h,m){if("object"===typeof exports&&"undefined"!==typeof module)module.exports=m();else if("function"===typeof define&&define.amd)define(m);else{var n=m();h.DOM=n.DOM;h.vDOM=n.vDOM}})(this,function(){var h={},m={},n=function(a){return"string"===typeof a},r=function(a,b){if(!a||!b)return!1;var c=!0;void 0===a[b]&&(c=b in a);return c},u=function(a,b){if(!n(a))return"";var c=a?a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,""):a||"";return c&&b?c.replace(/\r?\n|\r/g," ").replace(/\s\s+|\r/g," "):c},l,y,
t;l=function(a){var b=(n(a)?document.getElementById(a):a)||null;if(b&&b instanceof HTMLElement){var c=b.classList;b.hasClass=function(b){return(b=u(b,!0))?c.contains(b):!1};b.addClass=function(a){a=u(a,!0);if(!a)return!1;var e=a.split(" ");1<e.length?e.forEach(function(b){c.add(b)}):c.add(a);return b};b.removeClass=function(a){a=u(a,!0);if(!a)return!1;var e=a.split(" ");1<e.length?e.forEach(function(a){c.remove(a)}):c.remove(a);return b};b.toggleClass=function(a){a=u(a,!0);if(!a)return!1;var e=a.split(" ");
1<e.length?e.forEach(function(a){c.toggle(a)}):c.toggle(a);return b};b.empty=function(){b.innerHTML="";return b};b.html=function(a){if(void 0===a)return b.innerHTML;b.innerHTML=a;return b};b.destroy=function(){b.parentNode&&b.parentNode.removeChild(b)}}return b};y=function(a,b){var c=b?l(b):document.body,d=a instanceof HTMLElement?a:document.createElement(a);c.appendChild(d);return l(d)};t=function(a){return l(document.createElement(a))};h.ready=function(a){"loading"!==document.readyState?setTimeout(a,
0):document.addEventListener("DOMContentLoaded",a)};h.one=function(a){var b;(a=document.querySelector(a))&&(b=l(a));return b};h.all=function(a){var b=[];if(a=document.querySelectorAll(a))for(var c=0;c<a.length;c++)b.push(l(a[c]));return b};h.get=l;h.add=y;h.create=t;h.Event=function(){var a=function(a){a=a.toLowerCase();return/gecko/i.test(a)}(navigator.userAgent);return{on:function(b,c,d){"wheel"===c&&(c=a?"DOMMouseScroll":"mousewheel");b=n(b)?l(b):b;d=d||function(){};b.addEventListener?b.addEventListener(c,
d,!1):b.attachEvent&&b.attachEvent("on"+c,d)},off:function(a,c,d){a=n(a)?l(a):a;a.removeEventListener?a.removeEventListener(c,d,!1):a.detachEvent&&a.detachEvent("on"+c,d)},simulate:function(a,c){var d,e=n(a)?l(a):a;document.createEventObject?(d=document.createEventObject(),e.fireEvent("on"+c,d)):(d=document.createEvent("HTMLEvents"),d.initEvent(c,!0,!0),e.dispatchEvent(d))},stop:function(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();return!1},locate:function(a){a=
a||window.event;(a=a.target||a.srcElement)&&3===a.nodeType&&(a=a.parentNode);return l(a)}}}();var p=function(){this.data={}};p.prototype.set=function(a,b){this.data[a]=b;return this};p.prototype.get=function(a){return this.data[a]||null};p.prototype.has=function(a){return r(this.data,a)};p.prototype["delete"]=function(a){if(!this.has(a))return!1;var b=this.data;b[a]=null;delete b[a];return!0};var v=new p,w=new p,x=new p,D=function(a){a=JSON.stringify(a);return JSON.parse(a)};m.get=function(a,b){return a&&
n(a)?!0===b?{actual:v.get(a),virtual:w.get(a),mirror:x.get(a)}:w.get(a):null};m.remove=function(a){v["delete"](a);w["delete"](a);x["delete"](a)};var A=function(a,b){var c=[];if(a!==b){var d=a.length,e=b.length;if(0<Math.max(d,e)){for(var f=0;f<d;f++){for(var k=a[f],g=k.key,l=k.value,q=!1,h=0;h<e;h++){var m=b[h],k=m.value;if(m.key===g){q=!0;l!==k&&c.push({action:"Update",key:g,value:l});break}}q||c.push({action:"Remove",key:g,value:l})}for(f=0;f<e;f++){k=b[f];g=k.key;k=k.value;l=-1;for(q=0;q<d;q++)if(a[q].key===
g){l=q;break}0>l&&c.push({action:"Add",key:g,value:k})}}}return c},B=function(a,b){var c=[];if(a===b)return c;var c=[],d=[],e;for(e in a)a.hasOwnProperty(e)&&c.push({key:e,value:a[e]});for(var f in b)b.hasOwnProperty(f)&&d.push({key:f,value:b[f]});return A(c,d)},z=function(a,b){return a===b?[]:A(a,b)};m.diff=function(a,b){var c=[];if(a!==b){var d=B(a.attributes,b.attributes);d&&d.length&&(c=c.concat(d));(d=z(a.events,b.events))&&d.length&&(c=c.concat(d));var e;e=a.nodeList;var f=b.nodeList,k=[];if(e!==
f)for(var g=0;g<e.length;g++)for(var l=0;l<f.length;l++){var h=e[g],m=f[l];if(h.tagId===m.tagId){var n=B(h.attributes,m.attributes);n&&n.length&&(k=k.concat(n));(n=z(h.events,m.events))&&n.length&&(k=k.concat(n));(h=z(h.nodeList,m.nodeList))&&h.length&&(k=k.concat(h))}}e=k;e&&e.length&&(c=c.concat(d))}return c};var C=function(a,b){var c=b?y(a.tagName,b):t(a.tagName);c.setAttribute("tagId",a.tagId);var d=a.attributes,e;for(e in d)if(r(d,e)){var f=d[e];"text"===e?(f=document.createTextNode(f),c.appendChild(f)):
c.setAttribute(e,f)}var d=a.events,k;for(k in d)r(d,k)&&(e=d[k],h.Event.on(c,e.name,e.callback));k=a.nodeList;if(0<k.length)for(d=0;d<k.length;d++)C(k[d],c)},g=function(a,b,c,d){var e;for(e=[];10>e.length;)e.push(Math.random().toString(36).slice(2));e=e.join("");for(var f=e.length,k=Math.max(16,0),g="";g.length<k;)g+=e.charAt(Math.floor(Math.random()*f))||"";e=g;this.tagName=(l(a)||t(a)).tagName;this.tagId=e;this.attributes=b||Object.create(null);a=[];for(var h in c)r(c,h)&&(b=c[h])&&"[object Function]"===
{}.toString.call(b)&&a.push({name:h,callback:b});this.events=a;this.nodeList=d||[];v.set(e,null);x.set(e,null);w.set(e,this);return this};g.prototype.setAttribute=function(a,b){this.attributes[a]=b;return this};g.prototype.hasAttribute=function(a){return r(this.attributes,a)};g.prototype.getAttribute=function(a){return this.attributes[a]||null};g.prototype.removeAttribute=function(a){this.attributes[a]=null;delete this.attributes[a];return this};g.prototype.setEvent=function(a,b){this.events.push({name:a,
callback:b});return this};g.prototype.removeEvent=function(a){this.events[a]=null;delete this.events[a];return this};g.prototype.insert=function(a,b,c,d){a=new g(a,b,c,d);a.parentId=this.tagId;this.nodeList.unshift(a);return a};g.prototype.append=function(a,b,c,d){a=new g(a,b,c,d);a.parentId=this.tagId;this.nodeList.push(a);return a};g.prototype.find=function(a){var b,c=function(d){d=d.nodeList||[];if(0<d.length&&!b)for(var e=0;e<d.length;e++){var f=d[e];if(f.tagId===a){b=f;break}else c(f)}return b};
return c(this)||null};g.prototype.remove=function(a){var b=!1,c=function(d){var e=d.nodeList||[];if(0<e.length)for(var f=e.length-1;0<=f;f--){var g=e[f];if(g.tagId===a){e.splice(f,1);b=!0;d.nodeList=e;break}else c(g)}};c(this);return b};g.prototype.render=function(a){var b=this.tagId,c=h.one('[tagId="'+b+'"]');c||(c=t(this.tagName),c.setAttribute("tagId",b));if(c){(a=l(a))||(a=l(c.parentNode));for(var d=this.nodeList,e=c,f=0;f<d.length;f++)C(d[f],e);a.empty();a.appendChild(c);v.set(b,c);x.set(b,D(this))}};
m.Element=g;m.create=function(a,b,c,d){return new g(a,b,c,d)};return{DOM:h,vDOM:m}});